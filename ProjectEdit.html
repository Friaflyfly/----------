<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é¡¹ç›®ç¼–è¾‘ - å¤©åˆçŸ­å‰§å‰ªè¾‘æ¥å•å¹³å°</title>
  
  <!-- Ant Design CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/antd@5.12.8/dist/reset.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/antd@5.12.8/dist/antd.min.css">
  
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    .appLayout {
      display: flex;
      min-height: 100vh;
    }

    .sidebar {
      width: 200px;
      background: #fff;
      box-shadow: 2px 0 8px rgba(0, 0, 0, 0.06);
      position: fixed;
      left: 0;
      top: 0;
      bottom: 0;
      overflow-y: auto;
      z-index: 100;
    }

    .sidebarHeader {
      padding: 20px 16px;
      border-bottom: 1px solid #f0f0f0;
    }

    .logo {
      font-size: 18px;
      font-weight: 600;
      color: #1890ff;
      text-decoration: none;
      display: block;
    }

    .menu {
      padding: 16px 0;
    }

    .menuItem {
      display: block;
      padding: 12px 24px;
      color: #262626;
      text-decoration: none;
      font-size: 14px;
      transition: all 0.3s;
      border-left: 3px solid transparent;
    }

    .menuItem:hover {
      background-color: #f0f0f0;
      color: #1890ff;
    }

    .menuItem.active {
      background-color: #e6f7ff;
      color: #1890ff;
      border-left-color: #1890ff;
      font-weight: 500;
    }

    .menuItemIcon {
      margin-right: 8px;
      font-size: 16px;
    }

    .menuGroup {
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #f0f0f0;
    }

    .menuGroupTitle {
      padding: 8px 24px;
      font-size: 12px;
      color: #8c8c8c;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .mainContent {
      flex: 1;
      margin-left: 200px;
      min-height: 100vh;
      background: #f5f5f5;
    }

    .projectEditPage {
      padding: 24px;
    }

    .pageHeader {
      background: #fff;
      padding: 16px 24px;
      border-radius: 8px;
      margin-bottom: 16px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .formCard {
      background: #fff;
      border-radius: 8px;
      padding: 24px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    }

    @media (max-width: 768px) {
      .sidebar {
        display: none;
      }

      .mainContent {
        margin-left: 0;
      }
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
  
  <!-- Day.js -->
  <script src="https://cdn.jsdelivr.net/npm/dayjs@1.11.10/dayjs.min.js"></script>
  
  <!-- Ant Design JS -->
  <script src="https://cdn.jsdelivr.net/npm/antd@5.12.8/dist/antd.min.js"></script>
  
  <!-- Babel Standalone for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
    const { useState, useEffect } = React;
    const { Card, Button, Form, Input, Select, DatePicker, InputNumber, Upload, Typography, Tabs, message, Space, Tag } = antd;
    const { Title } = Typography;
    const { TextArea } = Input;
    const { Option } = Select;
    const { TabPane } = Tabs;

    const ProjectEdit = () => {
      const [form] = Form.useForm();
      const [loading, setLoading] = useState(false);
      const [isEditMode, setIsEditMode] = useState(false);
      const [projectId, setProjectId] = useState(null);
      const [fileList, setFileList] = useState([]);

      useEffect(() => {
        loadProjectData();
      }, []);

      const getUrlParam = (name) => {
        const urlParams = new URLSearchParams(window.location.search);
        return urlParams.get(name);
      };

      const loadProjectData = () => {
        const id = getUrlParam('id');
        const mode = getUrlParam('mode');
        
        if (mode === 'new' || !id) {
          setIsEditMode(false);
          // è®¾ç½®é»˜è®¤å€¼
          form.setFieldsValue({
            status: 'Draft',
            takeMode: 'æŠ¢å•',
            applyReviewRule: 'è¿è¥å®¡æ ¸',
            deliveryCycleDays: 7,
            quotaTotal: 5,
            difficulty: 'ç²¾å“',
            category: 'çŸ­å‰§',
            contentGenre: 'éœ¸æ€»',
            participantTeam: 'çº¿ä¸Š',
          });
          return;
        }

        setIsEditMode(true);
        setProjectId(id);

        // ä» localStorage åŠ è½½é¡¹ç›®æ•°æ®
        const projects = JSON.parse(localStorage.getItem('adminProjects') || '[]');
        const project = projects.find(p => p.id === id);

        if (project) {
          form.setFieldsValue({
            projectName: project.projectName,
            projectTags: project.projectTags || [],
            projectStage: project.projectStage || 'ç²¾å‰ªä¸­',
            contentGenre: project.contentGenre || 'éœ¸æ€»',
            category: project.category,
            difficulty: project.difficulty,
            participantTeam: project.participantTeam,
            budgetAmount: project.budgetAmount,
            expenseAmount: project.expenseAmount || 0,
            projectNote: project.projectNote || '',
            clientFeedback: project.clientFeedback || '',
            deliveryCycleDays: project.deliveryCycleDays || 7,
            dueTime: project.dueTime ? dayjs(project.dueTime) : null,
            episodeCount: project.episodeCount,
            unitPrice: project.unitPrice,
            productionDays: project.productionDays || null,
            productionStartTime: project.productionStartTime ? dayjs(project.productionStartTime) : null,
            coordinator: project.coordinator,
            participantMembers: project.participantMembers || [],
            takeMode: project.takeMode,
            quotaTotal: project.quotaTotal,
            applyReviewRule: project.applyReviewRule || 'è¿è¥å®¡æ ¸',
            candidates: project.candidates || [],
            requirementText: project.requirementText || '',
            requirementAttachments: project.requirementAttachments || [],
            materialNote: project.materialNote || '',
            materialPackageFiles: project.materialPackageFiles || [],
            deliveryRequirements: project.deliveryRequirements || {
              namingRule: '',
              resolution: '',
              bitrate: '',
              subtitleRule: '',
            },
            deliveryRequirementAttachments: project.deliveryRequirementAttachments || [],
          });
        } else {
          message.error('é¡¹ç›®ä¸å­˜åœ¨');
          setTimeout(() => {
            window.location.href = 'ProjectManagement.html';
          }, 1500);
        }
      };

      const handleSubmit = () => {
        form.validateFields().then(values => {
          setLoading(true);
          
          try {
            const projects = JSON.parse(localStorage.getItem('adminProjects') || '[]');
            
            const normalizeAttachments = (list) =>
              (list || []).map((f) => ({
                uid: f.uid,
                name: f.name,
                status: f.status || 'done',
                size: f.size,
              }));

            if (isEditMode && projectId) {
              // ç¼–è¾‘æ¨¡å¼
              const updatedProjects = projects.map(p => 
                p.id === projectId 
                  ? {
                      ...p,
                      ...values,
                      dueTime: values.dueTime ? values.dueTime.format('YYYY-MM-DD HH:mm:ss') : p.dueTime,
                      productionStartTime: values.productionStartTime ? values.productionStartTime.format('YYYY-MM-DD HH:mm:ss') : p.productionStartTime,
                      publishTime: p.publishTime || dayjs().format('YYYY-MM-DD HH:mm:ss'),
                      requirementAttachments: normalizeAttachments(values.requirementAttachments),
                      materialPackageFiles: normalizeAttachments(values.materialPackageFiles),
                      deliveryRequirementAttachments: normalizeAttachments(values.deliveryRequirementAttachments),
                    }
                  : p
              );
              localStorage.setItem('adminProjects', JSON.stringify(updatedProjects));
              message.success('é¡¹ç›®æ›´æ–°æˆåŠŸ');
            } else {
              // æ–°å»ºæ¨¡å¼
              const newProjectId = `proj_${String(Date.now()).slice(-6)}`;
              const newProject = {
                id: newProjectId,
                projectName: values.projectName,
                projectTags: values.projectTags || [],
                contentGenre: values.contentGenre,
                category: values.category,
                difficulty: values.difficulty,
                participantTeam: values.participantTeam,
                projectStage: values.projectStage || 'ç²¾å‰ªä¸­',
                budgetAmount: values.budgetAmount,
                expenseAmount: values.expenseAmount || 0,
                projectNote: values.projectNote || '',
                clientFeedback: values.clientFeedback || '',
                deliveryCycleDays: values.deliveryCycleDays,
                dueTime: values.dueTime ? values.dueTime.format('YYYY-MM-DD HH:mm:ss') : null,
                episodeCount: values.episodeCount,
                unitPrice: values.unitPrice,
                productionDays: values.productionDays || null,
                productionStartTime: values.productionStartTime ? values.productionStartTime.format('YYYY-MM-DD HH:mm:ss') : null,
                coordinator: values.coordinator,
                participantMembers: values.participantMembers || [],
                takeMode: values.takeMode,
                quotaTotal: values.quotaTotal,
                quotaTaken: 0,
                applyReviewRule: values.applyReviewRule || 'è¿è¥å®¡æ ¸',
                candidates: values.candidates || [],
                requirementText: values.requirementText || '',
                materialNote: values.materialNote || '',
                deliveryRequirements: values.deliveryRequirements || {},
                requirementAttachments: normalizeAttachments(values.requirementAttachments),
                materialPackageFiles: normalizeAttachments(values.materialPackageFiles),
                deliveryRequirementAttachments: normalizeAttachments(values.deliveryRequirementAttachments),
                status: values.status || 'Draft',
                publishTime: null,
                orderStats: {
                  inProgress: 0,
                  submitted: 0,
                  needRevision: 0,
                  approved: 0,
                  accepted: 0,
                },
                totalAmount: 0,
              };
              
              projects.push(newProject);
              localStorage.setItem('adminProjects', JSON.stringify(projects));
              message.success('é¡¹ç›®åˆ›å»ºæˆåŠŸ');
            }

            setTimeout(() => {
              window.location.href = 'ProjectManagement.html';
            }, 1000);
          } catch (error) {
            console.error('ä¿å­˜é¡¹ç›®å¤±è´¥:', error);
            message.error('ä¿å­˜å¤±è´¥ï¼Œè¯·é‡è¯•');
          } finally {
            setLoading(false);
          }
        }).catch(error => {
          console.error('è¡¨å•éªŒè¯å¤±è´¥:', error);
        });
      };

      // é¢„è®¾çš„é¡¹ç›®æ ‡ç­¾é€‰é¡¹
      const tagOptions = ['éœ¸æ€»', 'ç©¿è¶Š', 'ç”·é¢‘', 'å¥³é¢‘', 'å¤è£…', 'ä»™ä¾ ', 'ç§‘å¹»', 'ç¾é£Ÿ', 'ç”Ÿæ´»', 'çœŸäººç§€', 'å¨±ä¹'];

      return (
        <div className="appLayout">
          {/* å·¦ä¾§å¯¼èˆªæ  */}
          <div className="sidebar">
            <div className="sidebarHeader">
              <a href="Home.html" className="logo">ğŸ¬ å¤©åˆçŸ­å‰§å¹³å°</a>
            </div>
            <nav className="menu">
              <a href="Home.html" className="menuItem">
                <span className="menuItemIcon">ğŸ </span>
                é¦–é¡µ
              </a>
              <a href="ProjectHall.html" className="menuItem">
                <span className="menuItemIcon">ğŸ“‹</span>
                æ¥å•å¤§å…
              </a>
              <a href="Leaderboard.html" className="menuItem">
                <span className="menuItemIcon">ğŸ†</span>
                å¤©æ¢¯æ¦œå•
              </a>
              <a href="Account.html" className="menuItem">
                <span className="menuItemIcon">ğŸ’°</span>
                è´¦æˆ·ä¸æ”¶ç›Š
              </a>
              <a href="MyProjects.html" className="menuItem">
                <span className="menuItemIcon">ğŸš€</span>
                æˆ‘çš„é¡¹ç›®
              </a>
              
              <div className="menuGroup">
                <div className="menuGroupTitle">åå°ç®¡ç†</div>
                <a href="ReviewQueue.html" className="menuItem">
                  <span className="menuItemIcon">âœ…</span>
                  è®¢å•å®¡æ ¸
                </a>
                <a href="ProjectManagement.html" className="menuItem active">
                  <span className="menuItemIcon">ğŸ“‹</span>
                  é¡¹ç›®ç®¡ç†
                </a>
                <a href="StudentManagement.html" className="menuItem">
                  <span className="menuItemIcon">ğŸ‘¥</span>
                  å­¦å‘˜ç®¡ç†
                </a>
                <a href="FinanceManagement.html" className="menuItem">
                  <span className="menuItemIcon">ğŸ’°</span>
                  è´¢åŠ¡å¯¹è´¦
                </a>
                <a href="DashboardManagement.html" className="menuItem">
                  <span className="menuItemIcon">ğŸ“Š</span>
                  æ¦œå•ä¸æ•°æ®
                </a>
              </div>
            </nav>
          </div>

          {/* ä¸»å†…å®¹åŒº */}
          <div className="mainContent">
            <div className="projectEditPage">
              <div className="pageHeader">
                <Title level={2} style={{ margin: 0 }}>
                  {isEditMode ? 'ç¼–è¾‘é¡¹ç›®' : 'æ–°å»ºé¡¹ç›®'}
                </Title>
                <Space>
                  <Button onClick={() => window.location.href = 'ProjectManagement.html'}>
                    å–æ¶ˆ
                  </Button>
                  <Button type="primary" loading={loading} onClick={handleSubmit}>
                    {isEditMode ? 'ä¿å­˜' : 'åˆ›å»º'}
                  </Button>
                </Space>
              </div>

              <div className="formCard">
                <Form
                  form={form}
                  layout="vertical"
                  initialValues={{
                    status: 'Draft',
                    projectStage: 'ç²¾å‰ªä¸­',
                    takeMode: 'æŠ¢å•',
                    applyReviewRule: 'è¿è¥å®¡æ ¸',
                    deliveryCycleDays: 7,
                    quotaTotal: 5,
                    requirementAttachments: [],
                    materialPackageFiles: [],
                    deliveryRequirementAttachments: [],
                  }}
                >
                  <Tabs defaultActiveKey="basic">
                    {/* åŸºç¡€ä¿¡æ¯ */}
                    <TabPane tab="åŸºç¡€ä¿¡æ¯" key="basic">
                      <Form.Item
                        name="projectName"
                        label="é¡¹ç›®åç§°"
                        rules={[{ required: true, message: 'è¯·è¾“å…¥é¡¹ç›®åç§°' }, { max: 50, message: 'é¡¹ç›®åç§°ä¸èƒ½è¶…è¿‡50å­—' }]}
                      >
                        <Input placeholder="è¯·è¾“å…¥é¡¹ç›®åç§°" />
                      </Form.Item>

                      <Form.Item
                        name="projectTags"
                        label="é¡¹ç›®æ ‡ç­¾"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©é¡¹ç›®æ ‡ç­¾' }]}
                      >
                        <Select
                          mode="multiple"
                          placeholder="è¯·é€‰æ‹©é¡¹ç›®æ ‡ç­¾"
                          allowClear
                        >
                          {tagOptions.map(tag => (
                            <Option key={tag} value={tag}>{tag}</Option>
                          ))}
                        </Select>
                      </Form.Item>

                      <Form.Item
                        name="category"
                        label="å†…å®¹åˆ†ç±»"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©å†…å®¹åˆ†ç±»' }]}
                      >
                        <Select placeholder="è¯·é€‰æ‹©å†…å®¹åˆ†ç±»">
                          <Option value="çŸ­å‰§">çŸ­å‰§</Option>
                          <Option value="AIæ¼«å‰§">AIæ¼«å‰§</Option>
                          <Option value="çŸ­è§†é¢‘">çŸ­è§†é¢‘</Option>
                          <Option value="ç»¼è‰º">ç»¼è‰º</Option>
                        </Select>
                      </Form.Item>

                      <Form.Item
                        name="contentGenre"
                        label="å†…å®¹ç±»åˆ«"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©å†…å®¹ç±»åˆ«' }]}
                      >
                        <Select placeholder="è¯·é€‰æ‹©å†…å®¹ç±»åˆ«">
                          <Option value="éœ¸æ€»">éœ¸æ€»</Option>
                          <Option value="ç©¿è¶Š">ç©¿è¶Š</Option>
                          <Option value="ç”·é¢‘">ç”·é¢‘</Option>
                          <Option value="å¥³é¢‘">å¥³é¢‘</Option>
                        </Select>
                      </Form.Item>

                      <Form.Item
                        name="difficulty"
                        label="éš¾åº¦"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©éš¾åº¦' }]}
                      >
                        <Select placeholder="è¯·é€‰æ‹©éš¾åº¦">
                          <Option value="ç²¾å“">ç²¾å“</Option>
                          <Option value="å·¥å‚">å·¥å‚</Option>
                        </Select>
                      </Form.Item>

                      <Form.Item
                        name="participantTeam"
                        label="å‚ä¸å›¢é˜Ÿ"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©å‚ä¸å›¢é˜Ÿ' }]}
                      >
                        <Select placeholder="è¯·é€‰æ‹©å‚ä¸å›¢é˜Ÿ">
                          <Option value="å®è®­">å®è®­</Option>
                          <Option value="çº¿ä¸‹">çº¿ä¸‹</Option>
                          <Option value="çº¿ä¸Š">çº¿ä¸Š</Option>
                        </Select>
                      </Form.Item>

                      <Form.Item
                        name="projectStage"
                        label="é¡¹ç›®çŠ¶æ€"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©é¡¹ç›®çŠ¶æ€' }]}
                      >
                        <Select placeholder="è¯·é€‰æ‹©é¡¹ç›®çŠ¶æ€ï¼ˆé˜¶æ®µï¼‰">
                          <Option value="ç²¾å‰ªä¸­">ç²¾å‰ªä¸­</Option>
                          <Option value="å†…éƒ¨ä¸€å®¡">å†…éƒ¨ä¸€å®¡</Option>
                          <Option value="å†…éƒ¨äºŒå®¡">å†…éƒ¨äºŒå®¡</Option>
                          <Option value="å¯¼æ¼”å®¡">å¯¼æ¼”å®¡</Option>
                          <Option value="ç›‘åˆ¶å®¡">ç›‘åˆ¶å®¡</Option>
                          <Option value="å®¡æ ¸å®Œæˆ">å®¡æ ¸å®Œæˆ</Option>
                        </Select>
                      </Form.Item>
                    </TabPane>

                    {/* æˆæœ¬ä¸é¢„ç®— */}
                    <TabPane tab="æˆæœ¬ä¸é¢„ç®—" key="budget">
                      <Form.Item
                        name="budgetAmount"
                        label="é¢„ç®—é‡‘é¢"
                        rules={[{ required: true, message: 'è¯·è¾“å…¥é¢„ç®—é‡‘é¢' }, { type: 'number', min: 0, message: 'é¢„ç®—é‡‘é¢å¿…é¡»å¤§äºç­‰äº0' }]}
                      >
                        <InputNumber
                          style={{ width: '100%' }}
                          placeholder="è¯·è¾“å…¥é¢„ç®—é‡‘é¢"
                          min={0}
                          formatter={value => `Â¥ ${value}`.replace(/\B(?=(\d{3})+(?!\d))/g, ',')}
                          parser={value => value.replace(/Â¥\s?|(,*)/g, '')}
                        />
                      </Form.Item>

                      <Form.Item
                        name="expenseAmount"
                        label="å·²å‘ç”Ÿæ”¯å‡º"
                        rules={[{ type: 'number', min: 0, message: 'æ”¯å‡ºé‡‘é¢å¿…é¡»å¤§äºç­‰äº0' }]}
                      >
                        <InputNumber
                          style={{ width: '100%' }}
                          placeholder="è¯·è¾“å…¥å·²å‘ç”Ÿæ”¯å‡º"
                          min={0}
                          formatter={value => `Â¥ ${value}`.replace(/\B(?=(\d{3})+(?!\d))/g, ',')}
                          parser={value => value.replace(/Â¥\s?|(,*)/g, '')}
                        />
                      </Form.Item>

                      <Form.Item
                        name="projectNote"
                        label="é¡¹ç›®å¤‡æ³¨"
                        rules={[{ max: 2000, message: 'é¡¹ç›®å¤‡æ³¨ä¸èƒ½è¶…è¿‡2000å­—' }]}
                      >
                        <TextArea rows={4} placeholder="è¯·è¾“å…¥é¡¹ç›®å¤‡æ³¨ï¼ˆè¿è¥å†…éƒ¨å¤‡æ³¨ï¼‰" />
                      </Form.Item>

                      <Form.Item
                        name="clientFeedback"
                        label="ç”²æ–¹åé¦ˆ"
                        rules={[{ max: 2000, message: 'ç”²æ–¹åé¦ˆä¸èƒ½è¶…è¿‡2000å­—' }]}
                      >
                        <TextArea rows={4} placeholder="è¯·è¾“å…¥ç”²æ–¹åé¦ˆ" />
                      </Form.Item>
                    </TabPane>

                    {/* äº¤ä»˜ä¸æ’æœŸ */}
                    <TabPane tab="äº¤ä»˜ä¸æ’æœŸ" key="schedule">
                      <Form.Item
                        name="deliveryCycleDays"
                        label="äº¤ä»˜å‘¨æœŸï¼ˆå¤©ï¼‰"
                        rules={[{ required: true, message: 'è¯·è¾“å…¥äº¤ä»˜å‘¨æœŸ' }, { type: 'number', min: 1, message: 'äº¤ä»˜å‘¨æœŸå¿…é¡»å¤§äºç­‰äº1å¤©' }]}
                      >
                        <InputNumber
                          style={{ width: '100%' }}
                          placeholder="è¯·è¾“å…¥äº¤ä»˜å‘¨æœŸ"
                          min={1}
                        />
                      </Form.Item>

                      <Form.Item
                        name="episodeCount"
                        label="é›†æ•°"
                        rules={[{ required: true, message: 'è¯·è¾“å…¥é›†æ•°' }, { type: 'number', min: 1, message: 'é›†æ•°å¿…é¡»å¤§äºç­‰äº1' }]}
                      >
                        <InputNumber
                          style={{ width: '100%' }}
                          placeholder="è¯·è¾“å…¥é›†æ•°"
                          min={1}
                        />
                      </Form.Item>

                      <Form.Item
                        name="unitPrice"
                        label="å•ä»·ï¼ˆå…ƒ/é›†ï¼‰"
                        rules={[{ required: true, message: 'è¯·è¾“å…¥å•ä»·' }, { type: 'number', min: 0, message: 'å•ä»·å¿…é¡»å¤§äºç­‰äº0' }]}
                      >
                        <InputNumber
                          style={{ width: '100%' }}
                          placeholder="è¯·è¾“å…¥å•ä»·"
                          min={0}
                          formatter={value => `Â¥ ${value}`.replace(/\B(?=(\d{3})+(?!\d))/g, ',')}
                          parser={value => value.replace(/Â¥\s?|(,*)/g, '')}
                        />
                      </Form.Item>

                      <Form.Item
                        name="dueTime"
                        label="äº¤ä»˜æ—¶é—´ï¼ˆæˆªæ­¢æ—¶é—´ï¼‰"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©äº¤ä»˜æ—¶é—´' }]}
                      >
                        <DatePicker
                          showTime
                          style={{ width: '100%' }}
                          placeholder="è¯·é€‰æ‹©äº¤ä»˜æ—¶é—´"
                          disabledDate={(current) => current && current < dayjs().startOf('day')}
                        />
                      </Form.Item>

                      <Form.Item
                        name="productionDays"
                        label="åˆ¶ä½œå¤©æ•°"
                        rules={[{ type: 'number', min: 1, message: 'åˆ¶ä½œå¤©æ•°å¿…é¡»å¤§äºç­‰äº1' }]}
                      >
                        <InputNumber
                          style={{ width: '100%' }}
                          placeholder="è¯·è¾“å…¥åˆ¶ä½œå¤©æ•°ï¼ˆå¯åç½®å›å¡«ï¼‰"
                          min={1}
                        />
                      </Form.Item>

                      <Form.Item
                        name="productionStartTime"
                        label="åˆ¶ä½œå¼€å§‹æ—¶é—´"
                      >
                        <DatePicker
                          showTime
                          style={{ width: '100%' }}
                          placeholder="è¯·é€‰æ‹©åˆ¶ä½œå¼€å§‹æ—¶é—´ï¼ˆå¯é€‰ï¼‰"
                        />
                      </Form.Item>
                    </TabPane>

                    {/* äººå‘˜ä¸ç»„ç»‡ */}
                    <TabPane tab="äººå‘˜ä¸ç»„ç»‡" key="personnel">
                      <Form.Item
                        name="coordinator"
                        label="ç»Ÿç­¹äººå‘˜"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©ç»Ÿç­¹äººå‘˜' }]}
                      >
                        <Select placeholder="è¯·é€‰æ‹©ç»Ÿç­¹äººå‘˜">
                          <Option value="å¼ ä¸‰">å¼ ä¸‰</Option>
                          <Option value="æå››">æå››</Option>
                          <Option value="ç‹äº”">ç‹äº”</Option>
                        </Select>
                      </Form.Item>

                      <Form.Item
                        name="participantMembers"
                        label="å‚ä¸æˆå‘˜"
                      >
                        <Select
                          mode="multiple"
                          placeholder="è¯·é€‰æ‹©å‚ä¸æˆå‘˜ï¼ˆå¯é€‰ï¼‰"
                          allowClear
                        >
                          <Option value="å­¦å‘˜A">å­¦å‘˜A</Option>
                          <Option value="å­¦å‘˜B">å­¦å‘˜B</Option>
                          <Option value="å­¦å‘˜C">å­¦å‘˜C</Option>
                        </Select>
                      </Form.Item>
                    </TabPane>

                    {/* æ¥å•é…ç½® */}
                    <TabPane tab="æ¥å•é…ç½®" key="takeOrder">
                      <Form.Item
                        name="takeMode"
                        label="æ¥å•æ¨¡å¼"
                        rules={[{ required: true, message: 'è¯·é€‰æ‹©æ¥å•æ¨¡å¼' }]}
                      >
                        <Select placeholder="è¯·é€‰æ‹©æ¥å•æ¨¡å¼">
                          <Option value="æŠ¢å•">æŠ¢å•</Option>
                          <Option value="æŠ¥å">æŠ¥å</Option>
                        </Select>
                      </Form.Item>

                      <Form.Item
                        name="quotaTotal"
                        label="åé¢"
                        rules={[{ required: true, message: 'è¯·è¾“å…¥åé¢' }, { type: 'number', min: 1, message: 'åé¢å¿…é¡»å¤§äºç­‰äº1' }]}
                      >
                        <InputNumber
                          style={{ width: '100%' }}
                          placeholder="è¯·è¾“å…¥å¯æ¥å•äººæ•°"
                          min={1}
                        />
                      </Form.Item>

                      <Form.Item
                        noStyle
                        shouldUpdate={(prevValues, currentValues) => prevValues.takeMode !== currentValues.takeMode}
                      >
                        {({ getFieldValue }) => {
                          const takeMode = getFieldValue('takeMode');
                          return takeMode === 'æŠ¥å' ? (
                            <Form.Item
                              name="applyReviewRule"
                              label="æŠ¥åå®¡æ ¸ç­–ç•¥"
                            >
                              <Select placeholder="è¯·é€‰æ‹©æŠ¥åå®¡æ ¸ç­–ç•¥">
                                <Option value="è‡ªåŠ¨é€šè¿‡">è‡ªåŠ¨é€šè¿‡</Option>
                                <Option value="è¿è¥å®¡æ ¸">è¿è¥å®¡æ ¸</Option>
                              </Select>
                            </Form.Item>
                          ) : null;
                        }}
                      </Form.Item>

                      <Form.Item
                        name="candidates"
                        label="æŒ‡å®šå€™é€‰äºº"
                      >
                        <Select
                          mode="multiple"
                          placeholder="è¯·é€‰æ‹©æŒ‡å®šå€™é€‰äººï¼ˆå¯é€‰ï¼‰"
                          allowClear
                        >
                          <Option value="å­¦å‘˜A">å­¦å‘˜A</Option>
                          <Option value="å­¦å‘˜B">å­¦å‘˜B</Option>
                          <Option value="å­¦å‘˜C">å­¦å‘˜C</Option>
                        </Select>
                      </Form.Item>
                    </TabPane>

                    {/* éœ€æ±‚ä¸ç´ æ */}
                    <TabPane tab="éœ€æ±‚ä¸ç´ æ" key="requirements">
                      <Form.Item
                        name="requirementText"
                        label="é¡¹ç›®éœ€æ±‚ï¼ˆæ–‡æœ¬ï¼‰"
                        rules={[{ required: true, message: 'è¯·è¾“å…¥é¡¹ç›®éœ€æ±‚' }, { max: 5000, message: 'é¡¹ç›®éœ€æ±‚ä¸èƒ½è¶…è¿‡5000å­—' }]}
                      >
                        <TextArea rows={6} placeholder="è¯·è¾“å…¥é¡¹ç›®æ ¸å¿ƒéœ€æ±‚æè¿°" />
                      </Form.Item>

                      <Form.Item
                        name="requirementAttachments"
                        label="é¡¹ç›®éœ€æ±‚ï¼ˆé™„ä»¶ï¼‰"
                        valuePropName="fileList"
                        getValueFromEvent={(e) => (e && e.fileList) || []}
                      >
                        <Upload
                          maxCount={10}
                          beforeUpload={() => false}
                          accept=".pdf,.doc,.docx,.xls,.xlsx,.txt,.zip,.rar,.png,.jpg,.jpeg"
                          listType="text"
                        >
                          <Button type="default">ä¸Šä¼ é™„ä»¶</Button>
                        </Upload>
                      </Form.Item>

                      <Form.Item
                        name="materialNote"
                        label="ç´ æè¯´æ˜"
                        rules={[{ max: 2000, message: 'ç´ æè¯´æ˜ä¸èƒ½è¶…è¿‡2000å­—' }]}
                      >
                        <TextArea rows={4} placeholder="è¯·è¾“å…¥ç´ æåŒ…å†…å®¹ä¸ä½¿ç”¨è¯´æ˜ï¼ˆå¯¹ç´ æåŒ…å†…å®¹ä¸ä½¿ç”¨è¯´æ˜çš„è¡¥å……ï¼‰" />
                      </Form.Item>

                      <Form.Item
                        name="materialPackageFiles"
                        label="ç´ æåŒ…"
                        valuePropName="fileList"
                        getValueFromEvent={(e) => (e && e.fileList) || []}
                      >
                        <Upload
                          maxCount={20}
                          beforeUpload={() => false}
                          accept=".zip,.rar,.7z,.mp4,.mov,.mp3,.wav,.srt,.ass,.pdf,.doc,.docx"
                          listType="text"
                        >
                          <Button type="default">ä¸Šä¼ ç´ æåŒ…</Button>
                        </Upload>
                      </Form.Item>

                      <Form.Item label="äº¤ä»˜è¦æ±‚">
                        <Form.Item name={['deliveryRequirements', 'namingRule']} noStyle>
                          <Input placeholder="å‘½åè§„èŒƒï¼ˆä¾‹ï¼šé¡¹ç›®å_é›†æ•°_ç‰ˆæœ¬å·.mp4ï¼‰" />
                        </Form.Item>
                        <Form.Item name={['deliveryRequirements', 'resolution']} noStyle style={{ marginTop: 16 }}>
                          <Input placeholder="åˆ†è¾¨ç‡ï¼ˆä¾‹ï¼š1920x1080ï¼‰" />
                        </Form.Item>
                        <Form.Item name={['deliveryRequirements', 'bitrate']} noStyle style={{ marginTop: 16 }}>
                          <Input placeholder="ç ç‡ï¼ˆä¾‹ï¼š5000kbpsï¼‰" />
                        </Form.Item>
                        <Form.Item name={['deliveryRequirements', 'subtitleRule']} noStyle style={{ marginTop: 16 }}>
                          <Input placeholder="å­—å¹•è§„èŒƒï¼ˆä¾‹ï¼šSRTæ ¼å¼ï¼ŒUTF-8ç¼–ç ï¼‰" />
                        </Form.Item>
                        <Form.Item
                          name="deliveryRequirementAttachments"
                          label="äº¤ä»˜è¦æ±‚ï¼ˆé™„ä»¶ï¼‰"
                          style={{ marginTop: 16 }}
                          valuePropName="fileList"
                          getValueFromEvent={(e) => (e && e.fileList) || []}
                        >
                          <Upload
                            maxCount={10}
                            beforeUpload={() => false}
                            accept=".pdf,.doc,.docx,.xls,.xlsx,.txt,.zip,.rar"
                            listType="text"
                          >
                            <Button type="default">ä¸Šä¼ äº¤ä»˜è¦æ±‚é™„ä»¶</Button>
                          </Upload>
                        </Form.Item>
                      </Form.Item>
                    </TabPane>
                  </Tabs>
                </Form>
              </div>
            </div>
          </div>
        </div>
      );
    };

    window.addEventListener('load', function() {
      try {
        ReactDOM.render(<ProjectEdit />, document.getElementById('root'));
      } catch (error) {
        console.error('æ¸²æŸ“é”™è¯¯:', error);
        document.getElementById('root').innerHTML = '<div style="padding: 20px; color: red;">é¡µé¢åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯ä¿¡æ¯ã€‚</div>';
      }
    });
  </script>
</body>
</html>
